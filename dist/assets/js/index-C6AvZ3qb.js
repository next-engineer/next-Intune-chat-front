import{j as e,h as s}from"./index-COU3AFMd.js";import{r as a}from"./vendor-BlUkfZh9.js";import{L as t,I as n}from"./intune-input-Ds8I-Tn9.js";import{I as l}from"./intune-button-DDBXFbw-.js";import{U as i,L as r,R as c,a as m,M as o}from"./radio-group-D4pN0a8i.js";import{A as d,a as x,b as h,X as u}from"./x-DVyx8VBV.js";import{a as p}from"./utils-C-1G2k3o.js";import{A as j}from"./endPoint.constants-C9KNCxVz.js";import{A as f}from"./error.api-szfN1940.js";import{c as g}from"./createLucideIcon-CirrVwor.js";import"./router-BuIkA38J.js";import"./index-DoA_IopH.js";import"./index-KkN9daQ0.js";import"./button-2GnTG7u1.js";
/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=g("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),N=p.create({baseURL:j.BASE_URL,timeout:1e4,headers:{"Content-Type":"application/json"}});N.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),N.interceptors.response.use(e=>e,e=>{var s;return 401===(null==(s=e.response)?void 0:s.status)&&(localStorage.removeItem("token"),window.location.href="/signin"),Promise.reject(e)});const y=async e=>{try{return(await N.post(j.USER.CHECK_EMAIL_DUPLICATE,{email:e})).data}catch(s){throw f.handle(s)}},b=async e=>{try{return(await N.post(j.USER.CHECK_NICKNAME_DUPLICATE,{nickname:e})).data}catch(s){throw f.handle(s)}};function w(){const[p,j]=a.useState({email:"",password:"",nickname:"",gender:"",address:"",mbti:""}),[f,g]=a.useState({}),[N,w]=a.useState(!1),[k,C]=a.useState(!1),[S,A]=a.useState(null),[I,E]=a.useState(null),[L,U]=a.useState(!1),[M,R]=a.useState(!1),[q,z]=a.useState(""),P=(e,s)=>{j(a=>({...a,[e]:s})),"profileImage"!==e&&f[e]&&g(s=>({...s,[e]:""})),"email"===e&&(w(!1),A(null)),"nickname"===e&&(C(!1),E(null))},T=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),_=e=>e.length>=2&&e.length<=20;return e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return p.email?T(p.email)?N?!1===S&&(e.email="사용할 수 없는 이메일입니다."):e.email="이메일 중복 확인을 해주세요.":e.email="올바른 이메일 형식을 입력해주세요.":e.email="이메일을 입력해주세요.",p.password?p.password.length<6&&(e.password="비밀번호는 최소 6자 이상이어야 합니다."):e.password="비밀번호를 입력해주세요.",p.nickname?_(p.nickname)?k?!1===I&&(e.nickname="사용할 수 없는 닉네임입니다."):e.nickname="닉네임 중복 확인을 해주세요.":e.nickname="닉네임은 2~20자 사이로 입력해주세요.":e.nickname="닉네임을 입력해주세요.",p.gender||(e.gender="성별을 선택해주세요."),p.address||(e.address="주소를 입력해주세요."),p.mbti||(e.mbti="MBTI를 선택해주세요."),g(e),0===Object.keys(e).length})())try{const{hash:e,salt:a}=await s(p.password)}catch(a){}},className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"회원가입"}),e.jsx("p",{className:"text-subtext",children:"Intune에서 새로운 인연을 만나보세요"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(t,{className:"text-sm font-medium text-gray-900",children:"프로필 이미지"}),e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsxs(d,{className:"w-20 h-20",children:[e.jsx(x,{src:q||"/placeholder.svg"}),e.jsx(h,{children:e.jsx(i,{className:"w-8 h-8 text-gray-400"})})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(a){j(e=>({...e,profileImage:a}));const e=new FileReader;e.onload=e=>{var s;return z(null==(s=e.target)?void 0:s.result)},e.readAsDataURL(a)}},className:"hidden"}),e.jsx(l,{type:"button",variant:"outline",size:"sm",children:"이미지 선택"})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(n,{label:"이메일",type:"email",value:p.email,onChange:e=>P("email",e.target.value),error:f.email,success:!0===S?"사용 가능한 이메일입니다":"",required:!0,placeholder:"example@email.com"})}),e.jsx(l,{type:"button",variant:"outline",size:"sm",onClick:async()=>{if(p.email)if(T(p.email)){U(!0),g(e=>({...e,email:""}));try{const e=await y(p.email);A(e.isAvailable),w(!0),e.isAvailable||g(e=>({...e,email:"이미 사용 중인 이메일입니다."}))}catch(e){g(s=>({...s,email:e.message||"이메일 중복 확인에 실패했습니다. 다시 시도해주세요."})),A(!1),w(!1)}finally{U(!1)}}else g(e=>({...e,email:"올바른 이메일 형식을 입력해주세요."}));else g(e=>({...e,email:"이메일을 입력해주세요."}))},className:"mt-7",disabled:L,children:L?e.jsx(r,{className:"w-4 h-4 animate-spin"}):N?!0===S?e.jsx(v,{className:"w-4 h-4 text-green-600"}):e.jsx(u,{className:"w-4 h-4 text-red-600"}):"중복확인"})]}),e.jsx(n,{label:"비밀번호",type:"password",value:p.password,onChange:e=>P("password",e.target.value),error:f.password,required:!0,placeholder:"비밀번호를 입력하세요"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(n,{label:"닉네임",value:p.nickname,onChange:e=>P("nickname",e.target.value),error:f.nickname,success:!0===I?"사용 가능한 닉네임입니다":"",required:!0,placeholder:"닉네임을 입력하세요"})}),e.jsx(l,{type:"button",variant:"outline",size:"sm",onClick:async()=>{if(p.nickname)if(_(p.nickname)){R(!0),g(e=>({...e,nickname:""}));try{const e=await b(p.nickname);E(e.isAvailable),C(!0),e.isAvailable||g(e=>({...e,nickname:"이미 사용 중인 닉네임입니다."}))}catch(e){g(s=>({...s,nickname:e.message||"닉네임 중복 확인에 실패했습니다. 다시 시도해주세요."})),E(!1),C(!1)}finally{R(!1)}}else g(e=>({...e,nickname:"닉네임은 2~20자 사이로 입력해주세요."}));else g(e=>({...e,nickname:"닉네임을 입력해주세요."}))},className:"mt-7",disabled:M,children:M?e.jsx(r,{className:"w-4 h-4 animate-spin"}):k?!0===I?e.jsx(v,{className:"w-4 h-4 text-green-600"}):e.jsx(u,{className:"w-4 h-4 text-red-600"}):"중복확인"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(t,{className:"text-sm font-medium text-gray-900",children:["성별 ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(c,{value:p.gender,onValueChange:e=>P("gender",e),className:"flex space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{value:"M",id:"male"}),e.jsx(t,{htmlFor:"male",children:"남성"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{value:"F",id:"female"}),e.jsx(t,{htmlFor:"female",children:"여성"})]})]}),f.gender&&e.jsx("p",{className:"text-sm text-red-600",children:f.gender})]}),e.jsx(n,{label:"주소",value:p.address,onChange:e=>P("address",e.target.value),placeholder:"우편번호 검색을 통해 입력해주세요",error:f.address,required:!0}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(t,{className:"text-sm font-medium text-gray-900",children:["MBTI ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(o,{value:p.mbti,onChange:e=>P("mbti",e)}),f.mbti&&e.jsx("p",{className:"text-sm text-red-600",children:f.mbti})]}),e.jsx(l,{type:"submit",className:"w-full",size:"lg",children:"회원가입"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-subtext",children:["이미 계정이 있으신가요?"," ",e.jsx("button",{type:"button",className:"text-primary hover:underline",onClick:()=>window.location.href="/signin",children:"로그인"})]})})]})}function k(){return e.jsx("div",{className:"min-h-screen bg-soft flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(w,{})})})}export{k as default};
