import{j as e}from"./index-COU3AFMd.js";import{r as t,b as l}from"./vendor-BlUkfZh9.js";import{a}from"./utils-C-1G2k3o.js";import{A as s}from"./endPoint.constants-C9KNCxVz.js";import{d as i}from"./index-DoA_IopH.js";import"./router-BuIkA38J.js";const r=a.create({baseURL:s.NOTION.BASE_URL,timeout:1e4,headers:{Authorization:`Bearer ${{}.REACT_APP_NOTION_TOKEN}`,"Notion-Version":"2022-06-28","Content-Type":"application/json"}}),n={getDatabase:async e=>(await r.get(`${s.NOTION.DATABASES}/${e}`)).data,queryDatabase:async(e,t,l)=>(await r.post(`${s.NOTION.DATABASES}/${e}/query`,{filter:t,sorts:l})).data,getPage:async e=>(await r.get(`${s.NOTION.PAGES}/${e}`)).data,createPage:async(e,t)=>(await r.post(s.NOTION.PAGES,{parent:e,properties:t})).data,updatePage:async(e,t)=>(await r.patch(`${s.NOTION.PAGES}/${e}`,{properties:t})).data,getBlocks:async e=>(await r.get(`${s.NOTION.BLOCKS}/${e}/children`)).data,appendBlocks:async(e,t)=>(await r.patch(`${s.NOTION.BLOCKS}/${e}/children`,{children:t})).data,search:async(e,t,l)=>(await r.post(s.NOTION.SEARCH,{query:e,filter:t,sorts:l})).data},d=({databaseId:l,title:a})=>{var s,i;const[r,d]=t.useState(null),[o,c]=t.useState([]),[u,x]=t.useState(!0),[m,h]=t.useState(null);return t.useEffect(()=>{(async()=>{try{x(!0);const[e,t]=await Promise.all([n.getDatabase(l),n.queryDatabase(l)]);d(e),c(t.results)}catch(e){h(e instanceof Error?e.message:"데이터베이스를 불러오는 중 오류가 발생했습니다.")}finally{x(!1)}})()},[l]),u?e.jsx("div",{className:"flex justify-center items-center p-4",children:"로딩 중..."}):m?e.jsxs("div",{className:"text-red-500 p-4",children:["오류: ",m]}):r?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:a||(null==(i=null==(s=r.title)?void 0:s[0])?void 0:i.plain_text)||"Notion 데이터베이스"}),e.jsx("div",{className:"grid gap-4",children:o.map(t=>{var l,a,s,i,r,n,d,o;return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:(null==(i=null==(s=null==(a=null==(l=t.properties)?void 0:l.title)?void 0:a.title)?void 0:s[0])?void 0:i.plain_text)||(null==(o=null==(d=null==(n=null==(r=t.properties)?void 0:r.Name)?void 0:n.title)?void 0:d[0])?void 0:o.plain_text)||"제목 없음"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["생성일: ",new Date(t.created_time).toLocaleDateString("ko-KR")]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["수정일: ",new Date(t.last_edited_time).toLocaleDateString("ko-KR")]}),e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm mt-2 inline-block",children:"Notion에서 보기 →"})]},t.id)})}),0===o.length&&e.jsx("div",{className:"text-gray-500 text-center py-8",children:"데이터베이스에 항목이 없습니다."})]}):e.jsx("div",{className:"p-4",children:"데이터베이스를 찾을 수 없습니다."})},o=({pageId:l,title:a})=>{var s,i,r,d;const[o,c]=t.useState(null),[u,x]=t.useState([]),[m,h]=t.useState(!0),[p,v]=t.useState(null);t.useEffect(()=>{(async()=>{try{h(!0);const[e,t]=await Promise.all([n.getPage(l),n.getBlocks(l)]);c(e),x(t.results)}catch(e){v(e instanceof Error?e.message:"페이지를 불러오는 중 오류가 발생했습니다.")}finally{h(!1)}})()},[l]);return m?e.jsx("div",{className:"flex justify-center items-center p-4",children:"로딩 중..."}):p?e.jsxs("div",{className:"text-red-500 p-4",children:["오류: ",p]}):o?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:a||(null==(d=null==(r=null==(i=null==(s=o.properties)?void 0:s.title)?void 0:i.title)?void 0:r[0])?void 0:d.plain_text)||"Notion 페이지"}),e.jsxs("div",{className:"text-sm text-gray-600 mb-6",children:[e.jsxs("div",{children:["생성일: ",new Date(o.created_time).toLocaleDateString("ko-KR")]}),e.jsxs("div",{children:["수정일: ",new Date(o.last_edited_time).toLocaleDateString("ko-KR")]})]}),e.jsx("div",{className:"prose max-w-none",children:u.map(t=>{var l,a,s,i,r,n,d,o,c;const{type:u,content:x}=t;switch(u){case"paragraph":return e.jsx("p",{className:"mb-4",children:null==(l=null==x?void 0:x.rich_text)?void 0:l.map((t,l)=>{var a;return e.jsx("span",{className:(null==(a=t.annotations)?void 0:a.bold)?"font-bold":"",children:t.plain_text},l)})},t.id);case"heading_1":return e.jsx("h1",{className:"text-3xl font-bold mb-4",children:null==(a=null==x?void 0:x.rich_text)?void 0:a.map((e,t)=>e.plain_text).join("")},t.id);case"heading_2":return e.jsx("h2",{className:"text-2xl font-bold mb-3",children:null==(s=null==x?void 0:x.rich_text)?void 0:s.map((e,t)=>e.plain_text).join("")},t.id);case"heading_3":return e.jsx("h3",{className:"text-xl font-bold mb-2",children:null==(i=null==x?void 0:x.rich_text)?void 0:i.map((e,t)=>e.plain_text).join("")},t.id);case"bulleted_list_item":return e.jsx("li",{className:"ml-4 mb-1",children:null==(r=null==x?void 0:x.rich_text)?void 0:r.map((e,t)=>e.plain_text).join("")},t.id);case"numbered_list_item":return e.jsx("li",{className:"ml-4 mb-1",children:null==(n=null==x?void 0:x.rich_text)?void 0:n.map((e,t)=>e.plain_text).join("")},t.id);case"code":return e.jsx("pre",{className:"bg-gray-100 p-4 rounded-lg mb-4 overflow-x-auto",children:e.jsx("code",{children:null==(d=null==x?void 0:x.rich_text)?void 0:d.map((e,t)=>e.plain_text).join("")})},t.id);case"quote":return e.jsx("blockquote",{className:"border-l-4 border-gray-300 pl-4 mb-4 italic",children:null==(o=null==x?void 0:x.rich_text)?void 0:o.map((e,t)=>e.plain_text).join("")},t.id);default:return e.jsx("div",{className:"mb-4",children:null==(c=null==x?void 0:x.rich_text)?void 0:c.map((e,t)=>e.plain_text).join("")},t.id)}})}),e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"Notion에서 보기 →"})})]}):e.jsx("div",{className:"p-4",children:"페이지를 찾을 수 없습니다."})},c=l.memo(({item:l,onClick:a})=>{const s=t.useMemo(()=>{var e,t,a,s,i,r,n,d;return"properties"in l&&((null==(s=null==(a=null==(t=null==(e=l.properties)?void 0:e.title)?void 0:t.title)?void 0:a[0])?void 0:s.plain_text)||(null==(d=null==(n=null==(r=null==(i=l.properties)?void 0:i.Name)?void 0:r.title)?void 0:n[0])?void 0:d.plain_text))||"제목 없음"},[l]),i=t.useMemo(()=>"url"in l?"페이지":"데이터베이스",[l]);return e.jsx("div",{className:"p-3 border-b border-gray-200 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>a(l),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:s}),e.jsx("p",{className:"text-sm text-gray-500",children:i})]}),e.jsx("div",{className:"text-xs text-gray-400 ml-2",children:"페이지"===i?"📄":"🗃️"})]})})}),u=l.memo(({onSelect:l})=>{const[a,s]=t.useState(""),[r,d]=t.useState([]),[o,u]=t.useState(!1),[x,m]=t.useState(null),h=t.useMemo(()=>i(async e=>{if(e.trim())try{u(!0),m(null);const t=await n.search(e);d(t.results)}catch(t){m(t instanceof Error?t.message:"검색 중 오류가 발생했습니다."),d([])}finally{u(!1)}else d([])},300),[]),p=t.useCallback(e=>{s(e),h(e)},[h]),v=t.useCallback(e=>{e.preventDefault(),h(a)},[a,h]),N=t.useCallback(e=>{l&&l(e)},[l]),j=t.useCallback(e=>{const t=e.target.value;p(t)},[p]),b=t.useMemo(()=>o?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"검색 중..."}):x?e.jsx("div",{className:"p-4 text-center text-red-500",children:x}):0===r.length&&a.trim()?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"검색 결과가 없습니다."}):e.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.map((t,l)=>e.jsx(c,{item:t,onClick:N},`${t.id||l}`))}),[o,x,r,a,N]);return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("form",{onSubmit:v,className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a,onChange:j,placeholder:"Notion 페이지나 데이터베이스를 검색하세요...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),o&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:b})]})}),x=()=>{var l,a,s,i,r,n;const[c,x]=t.useState(null),[m,h]=t.useState("search");return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Notion 통합"}),e.jsx("p",{className:"text-gray-600",children:"Notion API를 통해 데이터베이스와 페이지를 조회하고 관리할 수 있습니다."})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("nav",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>{h("search"),x(null)},className:"px-4 py-2 rounded-lg font-medium "+("search"===m?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"),children:"검색"}),c&&e.jsx("button",{onClick:()=>{x(null),h("search")},className:"px-4 py-2 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700",children:"뒤로 가기"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:["search"===m&&e.jsx(u,{onSelect:e=>{x(e),h("url"in e?"page":"database")}}),"database"===m&&c&&!("url"in c)&&e.jsx("div",{className:"p-6",children:e.jsx(d,{databaseId:c.id,title:null==(a=null==(l=c.title)?void 0:l[0])?void 0:a.plain_text})}),"page"===m&&c&&"url"in c&&e.jsx("div",{className:"p-6",children:e.jsx(o,{pageId:c.id,title:null==(n=null==(r=null==(i=null==(s=c.properties)?void 0:s.title)?void 0:i.title)?void 0:r[0])?void 0:n.plain_text})})]}),e.jsxs("div",{className:"mt-8 bg-blue-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"사용법"}),e.jsxs("ul",{className:"text-blue-800 space-y-1",children:[e.jsx("li",{children:"• 검색 탭에서 Notion 페이지나 데이터베이스를 검색할 수 있습니다."}),e.jsx("li",{children:"• 검색 결과를 클릭하면 해당 항목의 상세 내용을 볼 수 있습니다."}),e.jsx("li",{children:"• 데이터베이스의 경우 모든 페이지 목록을 확인할 수 있습니다."}),e.jsx("li",{children:"• 페이지의 경우 모든 블록 내용을 렌더링하여 표시합니다."})]})]})]})})},m=()=>e.jsx(x,{});export{m as default};
