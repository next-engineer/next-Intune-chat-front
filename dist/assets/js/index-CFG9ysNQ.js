import{u as e,j as a,h as s}from"./index-COU3AFMd.js";import{r}from"./vendor-BlUkfZh9.js";import{L as t,I as n}from"./intune-input-Ds8I-Tn9.js";import{I as l}from"./intune-button-DDBXFbw-.js";import{U as i,R as d,a as c,M as m,L as o}from"./radio-group-D4pN0a8i.js";import{A as x,a as h,b as g}from"./x-DVyx8VBV.js";import{u}from"./router-BuIkA38J.js";import{A as p}from"./arrow-left-P4eanT4k.js";import{T as j}from"./trash-2-8BewEDgp.js";import{c as w}from"./createLucideIcon-CirrVwor.js";import{M as v}from"./MainLayout-Dp8IKWtJ.js";import"./index-DoA_IopH.js";import"./index-KkN9daQ0.js";import"./button-2GnTG7u1.js";import"./users-D3-gwMD9.js";
/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=w("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function b(){const w=u(),{user:v,setUser:b}=e(),[y,N]=r.useState({email:"",name:"",nickname:"",gender:"",address:"",mbti:"",currentPassword:"",newPassword:"",confirmPassword:""}),[k,P]=r.useState({}),[C,M]=r.useState(!1),[S,z]=r.useState(!1),[F,I]=r.useState(""),[L,_]=r.useState(!1),[q,A]=r.useState("");r.useEffect(()=>{v&&(N(e=>({...e,email:v.email,name:v.name,nickname:v.name,gender:"M",address:"서울시 강남구",mbti:"ENFP"})),v.avatar&&I(v.avatar))},[v]);const B=(e,a)=>{N(s=>({...s,[e]:a})),k[e]&&P(a=>({...a,[e]:""})),q&&A("")},D=()=>{N(e=>({...e,profileImage:void 0})),I("")},G=()=>{w(-1)};return v?a.jsxs("div",{className:"p-8",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("button",{onClick:G,className:"flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:[a.jsx(p,{className:"w-4 h-4"}),"뒤로 가기"]})}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};var a,s;return y.email?(a=y.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||(e.email="올바른 이메일 형식을 입력해주세요.")):e.email="이메일을 입력해주세요.",y.name?y.name.length<2&&(e.name="이름은 최소 2자 이상이어야 합니다."):e.name="이름을 입력해주세요.",y.nickname?(s=y.nickname).length>=2&&s.length<=20||(e.nickname="닉네임은 2~20자 사이로 입력해주세요."):e.nickname="닉네임을 입력해주세요.",y.gender||(e.gender="성별을 선택해주세요."),y.address||(e.address="주소를 입력해주세요."),y.mbti||(e.mbti="MBTI를 선택해주세요."),L&&(y.currentPassword||(e.currentPassword="현재 비밀번호를 입력해주세요."),y.newPassword&&(y.newPassword.length<6?e.newPassword="새 비밀번호는 최소 6자 이상이어야 합니다.":y.newPassword!==y.confirmPassword&&(e.confirmPassword="새 비밀번호와 확인 비밀번호가 일치하지 않습니다."))),P(e),0===Object.keys(e).length})()){z(!0),A("");try{await new Promise(e=>setTimeout(e,1e3));let e=null;if(L&&y.newPassword){const{hash:a}=await s(y.newPassword);e=a}const a={id:v.id,email:y.email,name:y.name,avatar:F||v.avatar,isAdmin:v.isAdmin},r="updated_access_token_"+Date.now(),t="updated_refresh_token_"+Date.now();await b(a,r,t),A("회원정보가 성공적으로 수정되었습니다!"),L&&(N(e=>({...e,currentPassword:"",newPassword:"",confirmPassword:""})),_(!1))}catch(a){P({email:"회원정보 수정에 실패했습니다. 다시 시도해주세요."})}finally{z(!1)}}},className:"space-y-6",children:[q&&a.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:a.jsx("p",{className:"text-green-700 dark:text-green-300 text-sm",children:q})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(t,{className:"text-sm font-medium text-gray-900 dark:text-white",children:"프로필 이미지"}),a.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsxs(x,{className:"w-24 h-24",children:[a.jsx(h,{src:F||"/placeholder.svg"}),a.jsx(g,{children:a.jsx(i,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})})]}),F&&a.jsx("button",{type:"button",onClick:D,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",title:"이미지 제거",children:a.jsx(j,{className:"w-3 h-3"})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("label",{className:"cursor-pointer",children:[a.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:e=>{var a,s;const r=null==(a=e.target.files)?void 0:a[0];if(!r)return;if(r.size>5242880)return void alert("파일 크기는 5MB 이하여야 합니다.");const t=null==(s=r.name.split(".").pop())?void 0:s.toLowerCase();if(!["image/jpeg","image/jpg","image/png"].includes(r.type)||!t||!["png","jpg","jpeg"].includes(t))return void alert("PNG 또는 JPG 형식의 파일만 업로드할 수 있습니다.");N(e=>({...e,profileImage:r}));const n=new FileReader;n.onload=e=>{var a;return I(null==(a=e.target)?void 0:a.result)},n.readAsDataURL(r)},className:"hidden"}),a.jsx(l,{type:"button",variant:"outline",size:"sm",children:"이미지 변경"})]}),F&&a.jsx(l,{type:"button",variant:"outline",size:"sm",onClick:D,className:"text-red-600 hover:text-red-700",children:"이미지 제거"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"JPG, PNG 형식, 최대 5MB"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(n,{label:"이메일",type:"email",value:y.email,onChange:e=>B("email",e.target.value),error:k.email,required:!0,placeholder:"example@email.com"}),a.jsx(n,{label:"이름",value:y.name,onChange:e=>B("name",e.target.value),error:k.name,required:!0,placeholder:"이름을 입력하세요"})]}),a.jsx(n,{label:"닉네임",value:y.nickname,onChange:e=>B("nickname",e.target.value),error:k.nickname,required:!0,placeholder:"닉네임을 입력하세요"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(t,{className:"text-sm font-medium text-gray-900 dark:text-white",children:["성별 ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs(d,{value:y.gender,onValueChange:e=>B("gender",e),className:"flex space-x-6",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(c,{value:"M",id:"male"}),a.jsx(t,{htmlFor:"male",className:"text-gray-900 dark:text-white",children:"남성"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(c,{value:"F",id:"female"}),a.jsx(t,{htmlFor:"female",className:"text-gray-900 dark:text-white",children:"여성"})]})]}),k.gender&&a.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:k.gender})]}),a.jsx(n,{label:"주소",value:y.address,onChange:e=>B("address",e.target.value),placeholder:"주소를 입력해주세요",error:k.address,required:!0}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(t,{className:"text-sm font-medium text-gray-900 dark:text-white",children:["MBTI ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(m,{value:y.mbti,onChange:e=>B("mbti",e)}),k.mbti&&a.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:k.mbti})]}),a.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"비밀번호 변경"}),a.jsx(l,{type:"button",variant:"outline",size:"sm",onClick:()=>_(!L),children:L?"취소":"비밀번호 변경"})]}),L&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(n,{label:"현재 비밀번호",type:"password",value:y.currentPassword,onChange:e=>B("currentPassword",e.target.value),error:k.currentPassword,placeholder:"현재 비밀번호를 입력하세요"}),a.jsx(n,{label:"새 비밀번호",type:"password",value:y.newPassword,onChange:e=>B("newPassword",e.target.value),error:k.newPassword,placeholder:"새 비밀번호를 입력하세요"}),a.jsx(n,{label:"새 비밀번호 확인",type:"password",value:y.confirmPassword,onChange:e=>B("confirmPassword",e.target.value),error:k.confirmPassword,placeholder:"새 비밀번호를 다시 입력하세요"})]})]}),a.jsxs("div",{className:"flex gap-4 pt-6",children:[a.jsx(l,{type:"submit",className:"flex-1",size:"lg",disabled:S,children:S?a.jsxs(a.Fragment,{children:[a.jsx(o,{className:"w-4 h-4 mr-2 animate-spin"}),"저장 중..."]}):a.jsxs(a.Fragment,{children:[a.jsx(f,{className:"w-4 h-4 mr-2"}),"저장"]})}),a.jsx(l,{type:"button",variant:"outline",size:"lg",onClick:G,children:"취소"})]})]})]}):a.jsx("div",{className:"p-8 text-center",children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"로그인이 필요합니다."})})}const y=()=>a.jsx(v,{children:a.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:a.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"회원정보 수정"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"개인정보를 안전하게 관리하고 업데이트할 수 있습니다."})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md",children:a.jsx(b,{})})]})})});export{y as default};
